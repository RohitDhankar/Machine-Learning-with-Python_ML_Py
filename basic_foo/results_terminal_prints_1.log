23/08/29 00:20:18 WARN Utils: Your hostname, dhankar-1 resolves to a loopback address: 127.0.1.1; using 192.168.1.2 instead (on interface enp2s0)
23/08/29 00:20:18 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
23/08/29 00:20:18 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).

[Stage 18:====================================>                     (5 + 3) / 8]

                                                                                
--[INFO]--type--spark-- <pyspark.sql.session.SparkSession object at 0x7fd0dea33b20>
+---------+---------+-----------------------------------+--------+-------------------+---------+----------+--------------+
|InvoiceNo|StockCode|Description                        |Quantity|InvoiceDate        |UnitPrice|CustomerID|Country       |
+---------+---------+-----------------------------------+--------+-------------------+---------+----------+--------------+
|536365   |85123A   |WHITE HANGING HEART T-LIGHT HOLDER |6       |2010-12-01 08:26:00|2.55     |17850.0   |United Kingdom|
|536365   |71053    |WHITE METAL LANTERN                |6       |2010-12-01 08:26:00|3.39     |17850.0   |United Kingdom|
|536365   |84406B   |CREAM CUPID HEARTS COAT HANGER     |8       |2010-12-01 08:26:00|2.75     |17850.0   |United Kingdom|
|536365   |84029G   |KNITTED UNION FLAG HOT WATER BOTTLE|6       |2010-12-01 08:26:00|3.39     |17850.0   |United Kingdom|
|536365   |84029E   |RED WOOLLY HOTTIE WHITE HEART.     |6       |2010-12-01 08:26:00|3.39     |17850.0   |United Kingdom|
+---------+---------+-----------------------------------+--------+-------------------+---------+----------+--------------+
only showing top 5 rows

-[INFO]-df_rtl.count()- 541909
-[INFO]-df_rtl--CustomerID').distinct().count(---> 4373
                                                                                                                                                                                    
+---------------+-------------+
|        Country|country_count|
+---------------+-------------+
| United Kingdom|         3950|
|        Germany|           95|
|         France|           87|
|          Spain|           31|
|        Belgium|           25|
|    Switzerland|           21|
|       Portugal|           19|
|          Italy|           15|
|        Finland|           12|
|        Austria|           11|
|         Norway|           10|
|Channel Islands|            9|
|        Denmark|            9|
|      Australia|            9|
|    Netherlands|            9|
|         Cyprus|            8|
|          Japan|            8|
|         Sweden|            8|
|         Poland|            6|
|         Canada|            4|
+---------------+-------------+
only showing top 20 rows

                                                                                                                                                                                    
+--------------------+-------------+
|Country             |country_count|
+--------------------+-------------+
|United Kingdom      |3950         |
|Germany             |95           |
|France              |87           |
|Spain               |31           |
|Belgium             |25           |
|Switzerland         |21           |
|Portugal            |19           |
|Italy               |15           |
|Finland             |12           |
|Austria             |11           |
|Norway              |10           |
|Netherlands         |9            |
|Denmark             |9            |
|Channel Islands     |9            |
|Australia           |9            |
|Japan               |8            |
|Cyprus              |8            |
|Sweden              |8            |
|Poland              |6            |
|Unspecified         |4            |
|Greece              |4            |
|USA                 |4            |
|Israel              |4            |
|Canada              |4            |
|EIRE                |3            |
|Malta               |2            |
|Bahrain             |2            |
|United Arab Emirates|2            |
|Iceland             |1            |
|Czech Republic      |1            |
+--------------------+-------------+
only showing top 30 rows

--[INFO]----df_1--->/n None
                                                                                                                                                                                    
                                                                                                                                                                                    
+-------------------+
|          max(date)|
+-------------------+
|2011-12-09 12:50:00|
+-------------------+

                                                            
+-------------------+
|          min(date)|
+-------------------+
|2010-12-01 08:26:00|
+-------------------+

                                                            
+-------------------+---------+
|from_date          |recency  |
+-------------------+---------+
|2012-01-10 08:26:00|-34992000|
|2012-01-10 08:26:00|-34992000|
|2012-01-10 08:26:00|-34992000|
|2012-01-10 08:26:00|-34992000|
|2012-01-10 08:26:00|-34992000|
+-------------------+---------+
only showing top 5 rows

                                                            
+-------+--------------------+
|summary|             recency|
+-------+--------------------+
|  count|              541909|
|   mean|-1.63974628436139...|
| stddev|1.0011907004935374E7|
|    min|           -34992000|
|    25%|           -24871800|
|    50%|           -15088140|
|    75%|            -7160340|
|    max|            -2748960|
+-------+--------------------+

                                                            
                                                            
+----------+-----------+
|CustomerID|max_recency|
+----------+-----------+
|15039.0   |-3531300   |
|16553.0   |-16821840  |
|13178.0   |-4983120   |
|17786.0   |-10092900  |
|12891.0   |-18734100  |
|16917.0   |-26598660  |
|17966.0   |-5954400   |
|15891.0   |-22276260  |
|17955.0   |-19859160  |
|12535.0   |-10625880  |
+----------+-----------+
only showing top 10 rows

--[INFO]--df_temp-->/n None
                                                            

[Stage 27:>                                                         (0 + 8) / 8]

[Stage 27:=====================>                                    (3 + 5) / 8]

[Stage 27:====================================>                     (5 + 3) / 8]

[Stage 27:==================================================>       (7 + 1) / 8]

                                                                                

[Stage 31:==============>                                           (2 + 6) / 8]

[Stage 31:===========================================>              (6 + 2) / 8]

                                                                                
+---------+---------+---------+-----------------------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+
|recency  |InvoiceNo|StockCode|Description                        |Quantity|InvoiceDate        |UnitPrice|CustomerID|Country       |date               |from_date          |
+---------+---------+---------+-----------------------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+
|-34986780|536384   |82484    |WOOD BLACK BOARD ANT WHITE FINISH  |3       |2010-12-01 09:53:00|6.45     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |84755    |COLOUR GLASS T-LIGHT HOLDER HANGING|48      |2010-12-01 09:53:00|0.65     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |22464    |HANGING METAL HEART LANTERN        |12      |2010-12-01 09:53:00|1.65     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |21324    |HANGING MEDINA LANTERN SMALL       |6       |2010-12-01 09:53:00|2.95     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |22457    |NATURAL SLATE HEART CHALKBOARD     |12      |2010-12-01 09:53:00|2.95     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |22469    |HEART OF WICKER SMALL              |40      |2010-12-01 09:53:00|1.45     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |22470    |HEART OF WICKER LARGE              |40      |2010-12-01 09:53:00|2.55     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |22224    |WHITE LOVEBIRD LANTERN             |6       |2010-12-01 09:53:00|2.95     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |21340    |CLASSIC METAL BIRDCAGE PLANT HOLDER|2       |2010-12-01 09:53:00|12.75    |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
|-34986780|536384   |22189    |CREAM HEART CARD HOLDER            |4       |2010-12-01 09:53:00|3.95     |18074.0   |United Kingdom|2010-12-01 09:53:00|2012-01-10 08:26:00|
+---------+---------+---------+-----------------------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+
only showing top 10 rows

--[INFO]--df_temp1-->/n None
                                                            
 Something Not Correct Above ??  .... cant seem to see the GroupBy ??  .... 
-[INFO]---df_temp1.printSchema-->
root
 |-- recency: long (nullable = true)
 |-- InvoiceNo: string (nullable = true)
 |-- StockCode: string (nullable = true)
 |-- Description: string (nullable = true)
 |-- Quantity: string (nullable = true)
 |-- InvoiceDate: string (nullable = true)
 |-- UnitPrice: string (nullable = true)
 |-- CustomerID: string (nullable = true)
 |-- Country: string (nullable = true)
 |-- date: timestamp (nullable = true)
 |-- from_date: timestamp (nullable = true)

                                                            
-[INFO]---df_temp1.summary-->
+-------+------------------+------------------+------------------+--------------------+-----------------+-------------------+-----------------+------------------+-----------+
|summary|           recency|         InvoiceNo|         StockCode|         Description|         Quantity|        InvoiceDate|        UnitPrice|        CustomerID|    Country|
+-------+------------------+------------------+------------------+--------------------+-----------------+-------------------+-----------------+------------------+-----------+
|  count|             94014|             94014|             94014|               93994|            94014|              94014|            94014|             91389|      94014|
|   mean|-9699289.210543111| 569544.9766467001|26865.789096555294|                null|8.218733380134873|               null|3.417466143340229|15354.287014848614|       null|
| stddev| 8212544.622902459|11670.936123143952|15419.854685152568|                null|362.6427630384355|               null|37.83584352630087| 1696.686273444772|       null|
|    min|         -34986780|            536384|             10002| 4 PURPLE FLOCK D...|               -1|2010-12-01 09:53:00|              0.0|           12346.0|  Australia|
|    25%|         -11986380|          564378.0|           22084.0|                null|              2.0|               null|             1.25|           13991.0|       null|
|    50%|          -6197580|          573415.0|           22669.0|                null|              4.0|               null|             1.95|           15408.0|       null|
|    75%|          -4057500|          578344.0|           23254.0|                null|             12.0|               null|             3.75|           16795.0|       null|
|    max|          -2748960|           C581569|              POST| wrongly coded 23343|               97|2011-12-09 12:50:00|            929.9|           18287.0|Unspecified|
+-------+------------------+------------------+------------------+--------------------+-----------------+-------------------+-----------------+------------------+-----------+

                                                            
-[INFO]---df_temp1.describe-->
+-------+------------------+------------------+------------------+--------------------+-----------------+-------------------+-----------------+------------------+-----------+
|summary|           recency|         InvoiceNo|         StockCode|         Description|         Quantity|        InvoiceDate|        UnitPrice|        CustomerID|    Country|
+-------+------------------+------------------+------------------+--------------------+-----------------+-------------------+-----------------+------------------+-----------+
|  count|             94014|             94014|             94014|               93994|            94014|              94014|            94014|             91389|      94014|
|   mean|-9699289.210543111| 569544.9766467001|26865.789096555294|                null|8.218733380134873|               null|3.417466143340229|15354.287014848614|       null|
| stddev| 8212544.622902459|11670.936123143952|15419.854685152568|                null|362.6427630384355|               null|37.83584352630087| 1696.686273444772|       null|
|    min|         -34986780|            536384|             10002| 4 PURPLE FLOCK D...|               -1|2010-12-01 09:53:00|              0.0|           12346.0|  Australia|
|    max|          -2748960|           C581569|              POST| wrongly coded 23343|               97|2011-12-09 12:50:00|            929.9|           18287.0|Unspecified|
+-------+------------------+------------------+------------------+--------------------+-----------------+-------------------+-----------------+------------------+-----------+

                                                            
-[INFO]---CustomerID--distinct--->
4373
                                                            
-[INFO]---Description--distinct--->
3474
                                                            
-[INFO]---Description--cnt_notNULL--->
93994
                                                            
-[INFO]---InvoiceDate--cnt_notNULL--->
94014
                                                            
-[INFO]---UnitPrice > 500--->
+-------+--------------------+------------------+-----------------+--------------------+------------------+-------------------+-----------------+------------------+--------------+
|summary|             recency|         InvoiceNo|        StockCode|         Description|          Quantity|        InvoiceDate|        UnitPrice|        CustomerID|       Country|
+-------+--------------------+------------------+-----------------+--------------------+------------------+-------------------+-----------------+------------------+--------------+
|  count|                  58|                58|               58|                  58|                58|                 58|               58|                48|            58|
|   mean|-1.43828151724137...|         562366.75|          22774.5|                null|0.5517241379310345|               null|868.3768965517241|14817.666666666666|          null|
| stddev|   9021725.737723302|13216.051553086672|80.05885992587926|                null|1.2019343151785082|               null|1257.010219409123|1796.4372345252286|          null|
|    min|           -31869300|            540970|            22655|          AMAZON FEE|                -1|2011-01-06 11:51:00|            106.4|           12349.0|        Canada|
|    25%|           -23385600|          548907.0|          22656.0|                null|              -1.0|               null|            150.0|           12881.0|          null|
|    50%|           -13128480|          564357.0|          22823.0|                null|               1.0|               null|            295.0|           14816.0|          null|
|    75%|            -6726240|          575632.0|          22827.0|                null|               1.0|               null|          1100.44|           16096.0|          null|
|    max|            -2757480|           C581499|             POST|VINTAGE RED KITCH...|                 4|2011-12-09 10:28:00|            929.9|           18233.0|United Kingdom|
+-------+--------------------+------------------+-----------------+--------------------+------------------+-------------------+-----------------+------------------+--------------+

                                                            
+-------+-----------------+
|summary|        UnitPrice|
+-------+-----------------+
|  count|               58|
|   mean|868.3768965517241|
| stddev|1257.010219409123|
|    min|            106.4|
|    25%|            150.0|
|    50%|            295.0|
|    75%|          1100.44|
|    max|            929.9|
+-------+-----------------+

                                                            
+---------+---------+---------+--------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+-----------+
|  recency|InvoiceNo|StockCode|         Description|Quantity|        InvoiceDate|UnitPrice|CustomerID|       Country|               date|          from_date|      idx_1|
+---------+---------+---------+--------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+-----------+
|-31869300|  C540271|        M|              Manual|      -1|2011-01-06 11:51:00|   1126.0|   12503.0|         Spain|2011-01-06 11:51:00|2012-01-10 08:26:00|          0|
|-31343640|   540970|    22827|RUSTIC  SEVENTEEN...|       1|2011-01-12 13:52:00|    165.0|   14185.0|United Kingdom|2011-01-12 13:52:00|2012-01-10 08:26:00|          1|
|-31263360|   541043|    22655|VINTAGE RED KITCH...|       2|2011-01-13 12:10:00|    125.0|   15510.0|United Kingdom|2011-01-13 12:10:00|2012-01-10 08:26:00|          2|
|-30843720|   541426|    22823|CHEST NATURAL WOO...|       4|2011-01-18 08:44:00|    110.0|   18233.0|United Kingdom|2011-01-18 08:44:00|2012-01-10 08:26:00|          3|
|-27886920|   544578|        M|              Manual|       1|2011-02-21 14:04:00|   320.69|   12365.0|        Cyprus|2011-02-21 14:04:00|2012-01-10 08:26:00| 8589934592|
|-26512920|   546088|    22826|LOVE SEAT ANTIQUE...|       1|2011-03-09 11:44:00|    195.0|   12881.0|United Kingdom|2011-03-09 11:44:00|2012-01-10 08:26:00| 8589934593|
|-25807920|   546862|    22828|REGENCY MIRROR WI...|       1|2011-03-17 15:34:00|    165.0|   16216.0|United Kingdom|2011-03-17 15:34:00|2012-01-10 08:26:00| 8589934594|
|-25555680|   547064|    22823|CHEST NATURAL WOO...|       1|2011-03-20 13:38:00|    125.0|   16096.0|United Kingdom|2011-03-20 13:38:00|2012-01-10 08:26:00| 8589934595|
|-25121220|   547814|    22656|VINTAGE BLUE KITC...|       1|2011-03-25 14:19:00|    295.0|   13452.0|United Kingdom|2011-03-25 14:19:00|2012-01-10 08:26:00| 8589934596|
|-24870900|  C547899|        M|              Manual|      -1|2011-03-28 11:51:00|  1486.12|      null|United Kingdom|2011-03-28 11:51:00|2012-01-10 08:26:00| 8589934597|
|-24869280|  C547908|        M|              Manual|      -1|2011-03-28 12:18:00|   646.46|      null|United Kingdom|2011-03-28 12:18:00|2012-01-10 08:26:00| 8589934598|
|-24860400|   547941|     POST|             POSTAGE|       1|2011-03-28 14:46:00|    150.0|   16692.0|United Kingdom|2011-03-28 14:46:00|2012-01-10 08:26:00| 8589934599|
|-24192060|   548907|    22655|VINTAGE RED KITCH...|       2|2011-04-05 08:25:00|    125.0|   15521.0|United Kingdom|2011-04-05 08:25:00|2012-01-10 08:26:00| 8589934600|
|-23929260|   549311|    22823|CHEST NATURAL WOO...|       1|2011-04-08 09:25:00|    125.0|   14924.0|United Kingdom|2011-04-08 09:25:00|2012-01-10 08:26:00|17179869184|
|-23385600|   550163|    22826|LOVE SEAT ANTIQUE...|       1|2011-04-14 16:26:00|    195.0|   14154.0|United Kingdom|2011-04-14 16:26:00|2012-01-10 08:26:00|17179869185|
|-23378640|   550185|    22826|LOVE SEAT ANTIQUE...|       1|2011-04-14 18:22:00|    195.0|   17142.0|United Kingdom|2011-04-14 18:22:00|2012-01-10 08:26:00|17179869186|
|-20990280|  C552876|        M|              Manual|      -1|2011-05-12 09:48:00|    929.9|   13235.0|United Kingdom|2011-05-12 09:48:00|2012-01-10 08:26:00|17179869187|
|-19768200|   554810|    22656|VINTAGE BLUE KITC...|       1|2011-05-26 13:16:00|    125.0|   14816.0|United Kingdom|2011-05-26 13:16:00|2012-01-10 08:26:00|17179869188|
|-19768200|   554810|    22655|VINTAGE RED KITCH...|       1|2011-05-26 13:16:00|    125.0|   14816.0|United Kingdom|2011-05-26 13:16:00|2012-01-10 08:26:00|17179869189|
|-17607540|   557471|    22655|VINTAGE RED KITCH...|       2|2011-06-20 13:27:00|    125.0|   15825.0|United Kingdom|2011-06-20 13:27:00|2012-01-10 08:26:00|25769803776|
+---------+---------+---------+--------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+-----------+
only showing top 20 rows

                                                            
+-------+--------------------+------------------+-----------------+--------------------+-------------------+-------------------+------------------+------------------+--------------+--------------------+
|summary|             recency|         InvoiceNo|        StockCode|         Description|           Quantity|        InvoiceDate|         UnitPrice|        CustomerID|       Country|               idx_1|
+-------+--------------------+------------------+-----------------+--------------------+-------------------+-------------------+------------------+------------------+--------------+--------------------+
|  count|                  54|                54|               54|                  54|                 54|                 54|                54|                44|            54|                  54|
|   mean|-1.31274677777777...| 564087.3243243244|22775.58823529412|                null|0.48148148148148145|               null| 904.4418518518519|14791.295454545454|          null|3.324622833179629...|
| stddev|   8015148.578619718|12192.124712411822|79.98832635416949|                null| 1.1115303192418957|               null|1290.7886078864099|1763.6207547232161|          null|1.710240915879371...|
|    min|           -27886920|            544578|            22655|          AMAZON FEE|                 -1|2011-02-21 14:04:00|             106.4|           12349.0|        Canada|          8589934592|
|    25%|           -19768200|          550185.0|          22656.0|                null|               -1.0|               null|            150.35|           12881.0|          null|         17179869188|
|    50%|           -11986380|          565377.0|          22823.0|                null|                1.0|               null|             300.0|           14816.0|          null|         34359738370|
|    75%|            -5251320|          575632.0|          22827.0|                null|                1.0|               null|           1100.44|           16096.0|          null|         51539607552|
|    max|            -2757480|           C581499|             POST|VINTAGE RED KITCH...|                  4|2011-12-09 10:28:00|             929.9|           18087.0|United Kingdom|         60129542150|
+-------+--------------------+------------------+-----------------+--------------------+-------------------+-------------------+------------------+------------------+--------------+--------------------+

                                                            
+--------+---------+---------+--------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+-----------+
| recency|InvoiceNo|StockCode|         Description|Quantity|        InvoiceDate|UnitPrice|CustomerID|       Country|               date|          from_date|      idx_1|
+--------+---------+---------+--------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+-----------+
|-2757480|  C581499|        M|              Manual|      -1|2011-12-09 10:28:00|   224.69|   15498.0|United Kingdom|2011-12-09 10:28:00|2012-01-10 08:26:00|60129542150|
|-2757600|   581498|      DOT|      DOTCOM POSTAGE|       1|2011-12-09 10:26:00|  1714.17|      null|United Kingdom|2011-12-09 10:26:00|2012-01-10 08:26:00|60129542149|
|-2911380|   581179|     POST|             POSTAGE|       1|2011-12-07 15:43:00|    240.0|   12471.0|       Germany|2011-12-07 15:43:00|2012-01-10 08:26:00|60129542148|
|-2934660|  C581009|        M|              Manual|      -1|2011-12-07 09:15:00|    125.0|   16971.0|United Kingdom|2011-12-07 09:15:00|2012-01-10 08:26:00|60129542147|
|-3078540|  C580726|     CRUK|     CRUK Commission|      -1|2011-12-05 17:17:00|  1100.44|   14096.0|United Kingdom|2011-12-05 17:17:00|2012-01-10 08:26:00|60129542146|
|-3078540|   580727|      DOT|      DOTCOM POSTAGE|       1|2011-12-05 17:17:00|  1599.26|   14096.0|United Kingdom|2011-12-05 17:17:00|2012-01-10 08:26:00|60129542145|
|-3340020|   580367|      DOT|      DOTCOM POSTAGE|       1|2011-12-02 16:39:00|   888.06|      null|United Kingdom|2011-12-02 16:39:00|2012-01-10 08:26:00|60129542144|
|-4057500|   578344|      DOT|      DOTCOM POSTAGE|       1|2011-11-24 09:21:00|   793.33|      null|United Kingdom|2011-11-24 09:21:00|2012-01-10 08:26:00|51539607558|
|-4314900|   577609|     POST|             POSTAGE|       1|2011-11-21 09:51:00|    300.0|   12349.0|         Italy|2011-11-21 09:51:00|2012-01-10 08:26:00|51539607557|
|-4748040|   576635|    22828|REGENCY MIRROR WI...|       2|2011-11-16 09:32:00|    145.0|   15269.0|United Kingdom|2011-11-16 09:32:00|2012-01-10 08:26:00|51539607556|
|-4825020|   576512|    22823|CHEST NATURAL WOO...|       4|2011-11-15 12:09:00|    110.0|   15524.0|United Kingdom|2011-11-15 12:09:00|2012-01-10 08:26:00|51539607555|
|-4998960|   575947|      DOT|      DOTCOM POSTAGE|       1|2011-11-13 11:50:00|  1211.17|      null|United Kingdom|2011-11-13 11:50:00|2012-01-10 08:26:00|51539607554|
|-5251320|   575632|        M|              Manual|       1|2011-11-10 13:44:00|   549.34|   12473.0|       Germany|2011-11-10 13:44:00|2012-01-10 08:26:00|51539607553|
|-5251320|   575632|        M|              Manual|       1|2011-11-10 13:44:00|   424.06|   12473.0|       Germany|2011-11-10 13:44:00|2012-01-10 08:26:00|51539607552|
|-6726240|  C572422|        M|              Manual|      -1|2011-10-24 12:02:00|   183.16|      null|United Kingdom|2011-10-24 12:02:00|2012-01-10 08:26:00|42949672965|
|-6726240|   572423|        M|              Manual|       1|2011-10-24 12:02:00|    464.9|   16742.0|United Kingdom|2011-10-24 12:02:00|2012-01-10 08:26:00|42949672964|
|-7160880|   571751|        M|              Manual|       1|2011-10-19 11:18:00|  2118.74|   12744.0|     Singapore|2011-10-19 11:18:00|2012-01-10 08:26:00|42949672963|
|-7160880|   571751|        M|              Manual|       1|2011-10-19 11:18:00|  3949.32|   12744.0|     Singapore|2011-10-19 11:18:00|2012-01-10 08:26:00|42949672962|
|-7161000|  C571750|        M|              Manual|      -1|2011-10-19 11:16:00|  2118.74|   12744.0|     Singapore|2011-10-19 11:16:00|2012-01-10 08:26:00|42949672961|
|-7161000|  C571750|        M|              Manual|      -1|2011-10-19 11:16:00|  3949.32|   12744.0|     Singapore|2011-10-19 11:16:00|2012-01-10 08:26:00|42949672960|
+--------+---------+---------+--------------------+--------+-------------------+---------+----------+--------------+-------------------+-------------------+-----------+
only showing top 20 rows

                                                            
+--------------+----------------------+
|       Country|freq_100_plus_purchase|
+--------------+----------------------+
|United Kingdom|                    46|
|     Singapore|                     4|
|       Germany|                     3|
|        Canada|                     1|
|        Israel|                     1|
|         Spain|                     1|
|        Cyprus|                     1|
|         Italy|                     1|
+--------------+----------------------+

                                                            
+--------------+--------------------+----------------------+
|       Country|         Description|freq_100_plus_purchase|
+--------------+--------------------+----------------------+
|United Kingdom|              Manual|                    17|
|United Kingdom|      DOTCOM POSTAGE|                     7|
|United Kingdom|VINTAGE RED KITCH...|                     4|
|United Kingdom|CHEST NATURAL WOO...|                     4|
|United Kingdom|REGENCY MIRROR WI...|                     3|
|United Kingdom|RUSTIC  SEVENTEEN...|                     3|
|United Kingdom|LOVE SEAT ANTIQUE...|                     3|
|United Kingdom|VINTAGE BLUE KITC...|                     2|
|United Kingdom|             POSTAGE|                     1|
|United Kingdom|     CRUK Commission|                     1|
|United Kingdom|          AMAZON FEE|                     1|
|         Spain|              Manual|                     1|
|     Singapore|              Manual|                     4|
|         Italy|             POSTAGE|                     1|
|        Israel|CHEST NATURAL WOO...|                     1|
|       Germany|              Manual|                     2|
|       Germany|             POSTAGE|                     1|
|        Cyprus|              Manual|                     1|
|        Canada|             POSTAGE|                     1|
+--------------+--------------------+----------------------+

                                                            
Filename: spark_1.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   170     82.7 MiB     82.7 MiB           1   @profile
   171                                         def run_analysis():
   172                                           """
   173                                           """
   174     83.7 MiB      1.0 MiB           1     df_rtl , spark = read_data()
   175     83.8 MiB      0.1 MiB           1     df_temp1 = retail_analysis(df_rtl , spark)
   176     83.8 MiB      0.0 MiB           1     df_temp2 = retail_analysis_1(df_temp1 , spark)


